<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="referrer" content="no-referrer" />
    <meta name="viewport" content="initial-scale=1,maximum-scale=4, minimum-scale=1,user-scalable=yes">
    <meta content="email=no" name="format-detection" />
    <title>基本信息</title>
    <!-- <script>
  document.documentElement.style.fontSize = document.documentElement.clientWidth / 7.5 + 'px';
</script> -->
    <style>
        .notice-subject {
            padding: .3rem 0;
            text-align: center;
            font-weight: bold;
            /* font-size: .3rem; */
        }

        table {
            border: 1px solid black;
            border-collapse: collapse;
            /* width: 100%; */
            /* margin: 0; */
            /* table-layout: fixed; */
            display: table;
            margin: 0 auto;
            width: 98%;
        }

        #type-two-border td {
            border: 1px solid #999;
        }

        #type-two-border img {
            width: 100%;
        }

        .title-red {
            color: red;
            border-bottom: 3px solid red;

        }

        .leader-title {
            width: 25%;
            text-align: center;
            padding: 0.2rem;
            font-size: .9rem;
        }

        .leader-content {
            text-align: center;
            padding: 0.2rem;
            font-size: .9rem;
        }
    </style>
</head>

<body>
    <div id="meeting" class="page-view">
        <div style="height: 100%;width: 100%;">
            <div id="text6" style="height: 100%;width: 100%;overflow: hidden;
   overflow-y: auto;">
                <!-- 办公用品 -->
                <div id="type-two-border" style="margin-top: 1rem;" v-if="module == 'goods'">
                    <div class="notice-box">
                        <div class="notice-subject">{{docInfor.businessSubject}}</div>
                        <div>
                            <table class="meeting-table">
                                <tr>
                                    <td class="leader-title">申请类型:</td>
                                    <td class="leader-content" colspan="4">{{docInfor.goodsType
                                        =='0'?'办公用品申领':'办公耗材申领'}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">申请日期:</td>
                                    <td class="leader-content" colspan="4">{{docInfor.applyDate}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">申请人:</td>
                                    <td class="leader-content" colspan="4">{{docInfor.userName}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">申请部门:</td>
                                    <td class="leader-content" colspan="4">{{docInfor.applyDeptName}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title" style="width: 20%;">序号</td>
                                    <td class="leader-title" style="width: 20%;">品名</td>
                                    <td class="leader-title" style="width: 20%;">单位</td>
                                    <td class="leader-title" style="width: 20%;">申领数量</td>
                                    <td class="leader-title" style="width: 20%;">备注</td>
                                </tr>
                                <template v-for="(obj,y) in docInfor.useRecordList">
                                    <tr>
                                        <td class="leader-title" style="width: 20%;">{{y + 1}}</td>
                                        <td class="leader-title" style="width: 20%;">{{obj.goodsName}}</td>
                                        <td class="leader-title" style="width: 20%;">{{obj.unit}}</td>
                                        <td class="leader-title" style="width: 20%;">{{obj.applyNumber}}</td>
                                        <td class="leader-title" style="width: 20%;">{{obj.remark}}</td>
                                    </tr>
                                </template>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- 办公耗材 -->
                <div id="type-two-border" style="margin-top: 1rem;" v-if="module == 'supplies'">
                    <div class="notice-box">
                        <div class="notice-subject">{{docInfor.businessSubject}}</div>
                        <div>
                            <table class="meeting-table">
                                <tr>
                                    <td class="leader-title">申请类型:</td>
                                    <td class="leader-content" colspan="4">{{docInfor.goodsType
                                        =='0'?'办公用品申领':'办公耗材申领'}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">申请日期:</td>
                                    <td class="leader-content" colspan="4">{{docInfor.applyDate}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">申请人:</td>
                                    <td class="leader-content" colspan="4">{{docInfor.userName}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">申请部门:</td>
                                    <td class="leader-content" colspan="4">{{docInfor.applyDeptName}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title" style="width: 20%;">序号</td>
                                    <td class="leader-title" style="width: 20%;">品名</td>
                                    <td class="leader-title" style="width: 20%;">单位</td>
                                    <td class="leader-title" style="width: 20%;">申领数量</td>
                                    <td class="leader-title" style="width: 20%;">备注</td>
                                </tr>
                                <template v-for="(obj,y) in docInfor.useRecordList">
                                    <tr>
                                        <td class="leader-title" style="width: 20%;">{{y + 1}}</td>
                                        <td class="leader-title" style="width: 20%;">{{obj.goodsName}}</td>
                                        <td class="leader-title" style="width: 20%;">{{obj.unit}}</td>
                                        <td class="leader-title" style="width: 20%;">{{obj.applyNumber}}</td>
                                        <td class="leader-title" style="width: 20%;">{{obj.remark}}</td>
                                    </tr>
                                </template>
                            </table>
                        </div>
                    </div>
                </div>
                  <!-- 工资单查询  -->
                  <div id="type-two-border" style="margin-top: 1rem;" v-if="module == 'finance' && docInfor.cardType == 0">
                    <div class="notice-box">
                        <div>
                            <table class="meeting-table">
                                <tr>
                                    <td class="leader-title">身份证号:</td>
                                    <td class="leader-content" colspan="3">{{docInfor.idNum}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">姓名</td>
                                    <td class="leader-content" colspan="3">{{docInfor.name}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">处室</td>
                                    <td class="leader-content" colspan="3">{{docInfor.orgName}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">级别技术等级工资</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.technicalLevelWages}}</td>
                                    <td class="leader-title">基本工资套改保留</td>
                                    <td class="leader-content">{{docInfor.financeSalaryCcbDto.basicWagesRetain}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">生活性补贴</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.livingAllowance}}</td>
                                    <td class="leader-title">工作性津贴</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.workAllowance}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">无线通信费</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.wirelessWages}}</td>
                                    <td class="leader-title">公务交通补贴</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.transportAllowance}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">警衔津贴</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.policeRankAllowance}}</td>
                                    <td class="leader-title">法院检察院工改津贴</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.procuratorateWagesRetain}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">特岗津贴</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.specialPostAllowance}}</td>
                                    <td class="leader-title">住房补贴</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.housingAllowance}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">年终奖金</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.yearEndBonus}}</td>
                                    <td class="leader-title">应发工资</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.wagesPayable}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">临时性补贴</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.temporaryAllowance}}</td>
                                    <td class="leader-title">补发工资</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.paybackWages}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">扣发工资</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.garnishWages}}</td>
                                    <td class="leader-title">住房公积金</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.housingFund}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">医疗金</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.medicalFund}}</td>
                                    <td class="leader-title">养老金</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.pensionFund}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">职业年金</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.carrerYearFund}}</td>
                                    <td class="leader-title">房租</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.rentFund}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">实发工资</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCcbDto.realWages}}</td>
                                    <td class="leader-title">登记人</td>
                                    <td class="leader-content" >{{docInfor.createUser}}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="type-two-border" style="margin-top: 1rem;" v-if="module == 'finance' && docInfor.cardType == 1">
                    <div class="notice-box">
                        <div>
                            <table class="meeting-table">
                                <tr>
                                    <td class="leader-title">身份证号:</td>
                                    <td class="leader-content" colspan="3">{{docInfor.idNum}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">姓名</td>
                                    <td class="leader-content" colspan="3">{{docInfor.name}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">处室</td>
                                    <td class="leader-content" >{{docInfor.orgName}}</td>
                                    <td class="leader-title">月综合综合绩效奖</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCiticDto.monthComprehensiveAward}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">省政府绩效考评优秀奖</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCiticDto.govCheckIndexExcellentAward}}</td>
                                    <td class="leader-title">改革创新突出奖</td>
                                    <td class="leader-content">{{docInfor.financeSalaryCiticDto.outstandingReformAward}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">应发工资</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCiticDto.wagesPayable}}</td>
                                    <td class="leader-title">代扣个税</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCiticDto.withholdingIndividualTax}}</td>
                                </tr>
                                <tr>
                                    <td class="leader-title">实发工资</td>
                                    <td class="leader-content" >{{docInfor.financeSalaryCiticDto.realWages}}</td>
                                    <td class="leader-title">登记人</td>
                                    <td class="leader-content" >{{docInfor.createUser}}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div id="FileBtn" class="foot-btn" :style="moreBtn?'height:auto':''">
                <div class="bottom-nav-box" v-for="item in detailPage.btnArrs"
                    @click="detailPage.toEvents(item.toEvent,$event)"><span class="rjicon"
                        :class="item.iconCss"></span><span v-cloak>{{item.btnName}}</span></div>
            </div>
        </div>
    </div>
    <script>
        console.log(JSON.parse(App.LS.get("docInfor")))
        var vFlow = new Vue({
            el: '#meeting',
            data() {
                return {
                    docInfor: JSON.parse(App.LS.get("docInfor")),
                    module: App.LS.get("module"),
                    moreBtn: false,
                }
            },
            mounted: function () {
                console.log(this.docInfor)
            },
            created: function () {
                console.log(this.docInfor)
            },
            methods: {
                replace: function (content) {
                    content = content.replace('text-indent:272pt;', 'text-align: right;');
                    content = content.replace('text-indent:264pt;', 'text-align: right;');
                    return content;
                },
                getFileIcon: function (fileSuffix) {
                    switch (fileSuffix) {
                        case "wps":
                            return "wps"
                            break;
                        case "doc":
                        case "docx":
                            return "word"
                            break;
                        case "xls":
                        case "xlsx":
                            return "excel"
                            break;
                        case "pdf":
                            return "pdf"
                            break;
                        case "ppt":
                            return "ppt"
                            break;
                        case "jpg":
                        case "jpeg":
                        case "png":
                            return "jpg"
                            break;
                        default:
                            return "qita"
                    }
                },
                getFileTask: function (fileSuffix) {
                    var fileTask = "";
                    if (fileSuffix.indexOf('doc') > -1) {
                        fileTask = "word2PDF"
                    } else if (fileSuffix.indexOf('wps') > -1) {
                        fileTask = "wps2PDF";
                    } else if (fileSuffix.indexOf('xls') > -1) {
                        fileTask = "excel2PDF";
                    } else if (fileSuffix.indexOf('ppt') > -1) {
                        fileTask = "ppt2PDF";
                    } else if (fileSuffix.indexOf('pdf') > -1) {
                        fileTask = "none";
                    } else if (fileSuffix.indexOf('jpg') > -1) {
                        fileTask = "jpg2PDF";
                    } else if (fileSuffix.indexOf('jpeg') > -1) {
                        fileTask = "jpg2PDF";
                    } else if (fileSuffix.indexOf('gif') > -1) {
                        fileTask = "gif2PDF";
                    } else if (fileSuffix.indexOf('png') > -1) {
                        fileTask = "png2PDF";
                    } else if (fileSuffix.indexOf('txt') > -1) {
                        fileTask = "txt2PDF";
                    } else {
                        fileTask = 1;
                    }
                    return fileTask;
                },
                initFileList: function (type) {
                    var _this = this;
                    $.each(fileLists[type], function (i, item) {
                        item.url = item.URL;
                        item.fileSuffix = (item.title.substring(item.title.lastIndexOf('.') + 1)).toLowerCase();
                        item.fileTask = _this.getFileTask(item.fileSuffix);
                        if (item.fileTask == 1) {
                            item.fcsUrl = fcsurl + 'fileurl=' + encodeURIComponent(item.url) + '&task=none&type=src&res=url&filetype=' + item.fileSuffix + '&jsoncallback=?';
                        } else {
                            item.fcsUrl = fcsurl + 'fileurl=' + encodeURIComponent(item.url) + '&task=' + item.fileTask + '&type=src&res=url&filetype=' + item.fileSuffix + '&jsoncallback=?';
                        }
                        item.fcsTransTime = 0;
                        item.fileType = type;
                        item.pdfurl = '';
                        item.index = i;
                        item.autoflag = false;
                        console.log(item);
                        _this.getPdfUrl(item);
                    })
                },
                fcsError: function (fileObj) {
                    if (fileObj.autoflag && fileObj.fcsTransTime == 3) {
                        toast("转换失败，重新发起.");
                        fileObj.pdfurl = "converFail";
                    } else if (fileObj.autoflag) {
                        this.getPdfUrl(fileObj);
                    }
                },
                getPdfUrl: function (fileObj) {
                    var _this = this;
                    // console.info(_url)
                    //ajaxRequst(_url,'post','application/x-www-form-urlencoded','text',obj).then(function(json){
                    ajaxRequst({
                        type: "GET",
                        url: fileObj.fcsUrl,
                        dataType: "jsonp",
                        jsonp: "jsoncallback"
                    }, function (result) {
                        fileObj.fcsTransTime++;
                        console.info(result)
                        if (result == "converFail" || result.Success === 'False' || result.Content === 'null') {
                            fcsError(fileObj);
                        } else {
                            //autoflag=true;
                            fileObj.pdfurl = fcsFilePath + result.Content;
                            if (fileObj.autoflag) {
                                _this.openFile(fileObj);
                            }
                        }

                    }, function (error) {
                        console.log(JSON.parse(error.responseText));
                        var _error = JSON.parse(error.responseText);
                        // toast(_error.msg)
                        //								try{wispApp.UI.dismissProgressDialog();}catch(e){}
                        toast("数据加载出错，请刷新重试！");
                        //								console.log(error);
                    }
                    )
                },
                openFile: function (fileObj) {
                    console.dir(fileObj)
                    var _self = this;
                    if (fileObj.pdfurl != "" && fileObj.pdfurl != "converFail") {
                        if (fileObj.fileTask == 1) {//不转换的情况
                            try {
                                var fileJson = { userName: App.LS.get("LastName"), isRead: true }
                                wispApp.H5plus.downloaFile(fileObj.pdfurl, {}, fileJson, function (filePath, fileProperty) {
                                    //alert("filePath:"+filePath);
                                    try { wispApp.UI.dismissProgressDialog(); } catch (e) { }
                                    if (/edc|bdc/i.test(fileObj.fileSuffix) && /Android/i.test(navigator.userAgent)) {
                                        var actionName = "android.intent.action.kinsecSignFile";
                                        var sd_path = plus.io.convertLocalFileSystemURL(filePath);
                                        var optionsJson = [{ openFile: sd_path, saveFile: "", screen: "all" }];
                                        wispApp.App.openapp("", "", actionName, optionsJson);
                                    } else {
                                        wispApp.App.openfile(filePath, {}, fileListPage.openErrorCallbak);
                                    }
                                    /*plus.runtime.openFile(filePath,{},function(error){
                                        wispApp.UI.showToast(error.message);
                                    });*/
                                });
                            } catch (e) { alert(e) }
                        } else {
                            //window.open('./pdfh5/pdfh5.html?fileUrl='+fileObj.pdfurl+'&fileTitle='+fileObj.title)  
                            wispApp.H5plus.creatWebview('./pdfh5/pdfh5.html?fileUrl=' + fileObj.pdfurl + '&fileTitle=' + fileObj.title + '&ver=' + App.LS.get('appRes'), 'fileRead', '文件');
                        }
                    } else if (fileObj.pdfurl == "") {
                        this.getPdfUrl(fileObj);
                    }

                },
                openErrorCallbak: function (error) {
                    wispApp.UI.showToast(error.message);
                }
            }
        });
    </script>
</body>

</html>